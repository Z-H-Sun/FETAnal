# FETAnal
Automatic analysis of FET transfer transfer characteristics data recorded by a [**Kathley**](http://www.tek.com/Keithley) semiconductor test system. Calculated mobility, threshold voltage and on/off ratio of each test will be given.

## Features
* A cross-platform python program
* High robustness
* User friendly
* Automatic analysis in batch mode
* Build-in smoothing function for the transfer curve
* Produces detailed information such as mobility-voltage correlation *μ*(*V*<sub>gs</sub>)

## Runtime Environment
The requirements listed below are recommended for running this program. If not met, however, workarounds are also provided here.

### For Windows
* Windows 7 x64 or higher
* .NET 3.5 \[Built in to Windows 7; one-click activation in Windows 10\]
* Python 3.4 or higher (\*) **with PyWin32 installed** and with following libraries

  * Numpy >= 1.12 \[also required by Matplotlib\]
  * Matplotlib >= 2.2
  * xlrd >= 1.0

(\*) *If you have Python installed*, you can download [this package](https://github.com/Z-H-Sun/FETAnal/releases/download/v1.04/FETAnal_1.04_Win.zip) and it can **automatically take care of the dependencies of Python libraries**. However, a latest version of `pip` is required. Or you can do the manual setup by running `pip install matplotlib` and `pip install xlrd` in `cmd`.

*If you have not installed Python and do not intend to*, try [this one](https://github.com/Z-H-Sun/FETAnal/releases/download/v1.04/FETAnal_1.04_Win_PRE.zip) with Python environment packed in a single executables. This is deprecated though, since it runs much slower, given that it will first release a Python environment into temporary path.

### For Mac OS
* Mac OS X 10.10 or higher

Fortunately, Python 2.7 with Matplotlib 1.3 and Numpy 1.8 was built-in to Mac OS X. However, `xlrd` should be set up additionally; **Or, if you do not want to deal with those `pip` stuff, we provide [this package](https://github.com/Z-H-Sun/FETAnal/releases/download/v1.04/FETAnal_1.04_Mac.zip) with xlrd 1.2.0 integrated** \(which was extracted from official website [PyPI.org](https://pypi.org/project/xlrd/)\).

### For Linux
* Must be with a desktop environment to display GUI
* Python >= 2.7 with

  * Numpy >= 1.8
  * Matplotlib >= 1.3
  * xlrd >= 1.0
  
After proper deployment, only [FETAnal](/FETAnal) and [Config.ini](/Config.ini) need to be downloaded. Place them in the same folder. Run `chmod +x FETAnal` in bash to make it executable.

For Unix systems (Mac OS X and Linux), if you have deployed a Python3 environment rather than Python2, you may want to change the first line of `FETAnal` to `#!/usr/bin/env python3` instead.

## How to use
### Before you run
* Be sure to follow the instructions in [the previous section](/README.md#runtime-environment) to **download and set up properly**;
* Make sure you have **set up all experimental parameters properly in `Config.ini`** following the instructions inside, including the dielectric layer property, length-to-width ratio, column number in the spreadsheet, etc. The section [Examples](/README.md#examples) will show you more detailedly about the settings.
* If you leave `ColGateV` and `ColIDrain` zeros, the program will automatically find the column numbers of *V*<sub>gs</sub> and *I*<sub>ds</sub> from spreadsheets, in which case you must make sure that the column headers are named exactly as "GateV" and "IDRAIN"/"IDLIN", respectively.
* If you leave `W` and `L` zeros, the program will automatically find the widths and lengths of channel from filenames, in which case you must name the spreadsheet files this way: \*\<width\>\*\<length\>\*.xls, where \<width\> or \<length\> must be a number **followed by the unit**, "um" (some acceptable versions: 100um, 1mm, 50 um, 50-um, 50_um, etc.).

### Run the program
* For Windows and Mac OS X, double-click on the executable to run;

  * For Mac OS X, make sure that the default application for executables is "Terminal"
  * For Mac OS X, execution of Internet files may be blocked by the system's gatekeeper; you can write the file yourself by copying the source code of [FETAnal](/FETAnal) to it, or you may "Allow Apps from Anywhere" to solve the problem
* For either Windows, Mac, or Linux, you can also run `<path/to/>FETAnal` in cmd/bash to lunch the program;
* When prompted to "Enter \`-config' or .xls files array or their path", you can do any of the following:

  * Entering `-config`, which will open `Config.ini` for you to check or change the settings;
  * Entering a folder's name, after which all the .xls or .xlsx files inside will be analyzed;
  * Entering a single filename, or a series of filenames, **each separated with space**, after which these .xls or .xlsx files will be analyzed

    * No need to worry if any spreadsheet among them are *not* generated by transfer characteristics measurements, since they will be ignored by the program;
    * Note that if the filename/dirname contains spaces, you need to use quotation marks to wrap around it (or in Mac OS, you can use `\ ` to escape a space character)
    * The filename/dirname should not be longer than 260 characters, which is caused by Python, so please don't blame me for that :)

  * Dragging the folder/file/files of interest to the terminal, which can save effort in inputing (Typically, the system will take care of the "space-in-filename" issue for you, so you do not need to do anything else);

    * \[For Windows only\], dragging the folder/file/files *to the executable* **can do the same trick with above**;

* For either Windows, Mac OS, or linux, to run `<path/to/>FETAnal [bar] [foo]` in cmd/bash **is equivalent to** running the program without arguments followed by entering `[bar] [foo]` to the program;

### Results Output
<p align="center"><img src="/screenshot.png" width="80%" height="80%"></p>

* Data processing: each transfer curve is smoothed with a Savitzky-Golay filter, and then every five points are taken for a linear fit. The mobility (*μ*) and threshold voltage (*V*<sub>th</sub>) are then extracted using the following equation:<p align="center">√*I*<sub>ds</sub> = √\[(*μ C' W*)/(2*L*)\] (*V*<sub>gs</sub> − *V*<sub>th</sub>)</p>
* For each spreadsheet, unless not applicable, the program will print some important results to the terminal as shown in the picture above. They are: maximal mobility (*μ*) and threshold voltage (*V*\_th) in both forward scan (f) and backward scan (b), and on/off ratio.
* The aforementioned results will also be saved to `./Results/Results_mmddyy_HHMMSS.csv`, which you may open with Microsoft Excel. *If multiple files are analyzed, the path of the first file will be taken as the storage path.* A more detailed and exhaustive report is saved to `./Results/Data_mmddyy_HHMMSS.csv`, including the correlation between mobility/threshold voltage and gate voltage, *μ*(*V*<sub>gs</sub>) and *V*<sub>th</sub>(*V*<sub>gs</sub>).
* Figure of transfer curves will be shown in a separate GUI window, where square (scatter gram) is for √I-V, solid line for smoothed transfer curve, dashed line for linear fit (where *μ* is maximal), "+" (scatter gram) for mobility-voltage correlation, and different colors for distinguishing a forward scan from a backward one.
* These figures are stored at "./Results/\<filename\>.png" (or .svg, .bmp or some other formats else if you change `PICEXT` in `Config.ini`).
* Scroll the mouse wheel on the figure to view the previous/next one.

## Examples
* Two examples are provided [here](/Examples). You can download them as a zip file [here](https://github.com/Z-H-Sun/FETAnal/releases/download/v1.04/Examples.zip).
* For 'arc CNT', set DIELECTRIC = 0, W, L = 0, 0, and TD\[0\] = 300 which means the dielectric layer is SiOx of 300 nm thick, and the length-to-width ratio will be automatically extracted from filenames.
* For 'cytop', set DIELECTRIC = -1 and DCP = 3.7e-9, since the reported capacitance of CYTOP dielectric layer (processed through a certain procedure) is 3.7×10<sup>−9</sup> F/cm<sup>2</sup>; besides, set W, L = 20, 1, which means the length-to-width ratio of the channel is 1/20 for **every test** (so you do not need to specify in the filename). Note that in this folder, 'TPDBP-C-3-o' recorded the data of output characteristics rather than transfer characteristics, but do not worry since the program will leave it alone and process the data in other files properly.

## Developers
* If you want to compile the Python script on Windows, you may use `PyInstaller` by running `Compile\make.bat`. It is crucial **not** to install `numpy` higher than 1.16.2 nor `matplotlib` higher than 3.0.2. *If you don't believe that, just try and you'll know why*.
* If you want to compile the "wrapper script" executable, you may need Visual Studio and [ModuleMain.vb](/ModuleMain.vb).
